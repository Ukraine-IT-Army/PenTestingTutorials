# NMAP

---

## Introduction

NMAP (https://nmap.org/) is the best and most commonly used tool to Enumerate servers, and anything network related, it is easy to use and has hundreds if not thousands of available tools.

Today we will be focusing on the most basic functions that will allow you to start as soon as possible, but you are encouraged to visit the official site and learn more (or use your OSINT tools and find some tutorials)

---

## How it works

Bear with me, this section will only discuss theory. It is important you understand at least the extreme basics of how a program like NMAP works along with basic network understanding. I'll attempt to make this section as short and easy to understand as possible.

Networks work like the post office, in order to communicate with others (servers in this case) you send a letter to their address, and they will return one to you as well. Cointained in this letter there will be lots of information, including where it was sent from, who sent it, with what technology it was sent, and other relevant data. On top of all of this you will also receive the data you requested. For most people that is all they care about. For us, not so much.

We could try to do this manually or even make our own program, but thankfully a tool was born to do this job, **NMAP** , this were it's origins, it has now grown to be able to do thousands of things. But we will focus on the most basic functionality it offers, scanning servers.

---

## Usage

Let's get started. As mentioned before we will be using NMAP to scan website servers or other IPs that might be given by the Ukraininan Government via the Telegram IT ARMY group (https://t.me/itarmyofukraine2022) or via other communication.

#### Download

The first thing you need to do is download the tool if you do not have it already, visit the link below and follow the instructions, they explian it better and more in-depth than I could here given the time restrictions.

https://nmap.org/download

#### First use

Once you have downloaded the tool you're ready to start investigating and finding vulnerabilites to exploit, but how do you do that?

nmap follows the linux / unix notation where you use the tool by writing its name on the terminal followed by whatever function you want to use from the tool itself. 

example:
```bash
nmap tell_me_all_information_about IP 
```
unfortunately nmap is not so verbose, so we need to speak to it in a language it understands, the correct way to request NMAP to search a server would be the following, replace %IP with the IP you're interested in scanning, alternatively you could also use a website URL

```bash
nmap $IP
```
```bash
nmap $website
```
by running this command nmap will communicate with the server and request information from it, the equivalent of checking doors and windows on a house to see if any are open. the very important thing to keep in mind is it will not test all 'doors and windows' on a server, only the most common 1000, this is because all computers contain thousands of ports and it would be time consuming to test all of them, if you wish to do so, go to the bottom section, **Common NMAP usage** to see how to request NMAP to scan all ports.

#### Understanding Output

Once you have done all of the steps above you might find that what NMAP is telling you makes no sense, don't worry it is normal to be confused at the beginning.

this is an exmaple of what a scan might look like when using nmap
```bash
Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 21:16 IST
Nmap scan report for router (192.168.2.254)
Host is up, received arp-response (0.00026s latency).
Not shown: 995 filtered ports
Reason: 995 no-responses
PORT    STATE SERVICE REASON
22/tcp  open  ssh     syn-ack ttl 64
53/tcp  open  domain  syn-ack ttl 64
80/tcp  open  http    syn-ack ttl 64
443/tcp open  https   syn-ack ttl 64
666/tcp open  doom    syn-ack ttl 64
MAC Address: 00:08:A2:0D:05:41 (ADI Engineering)
 
Nmap done: 1 IP address (1 host up) scanned in 4.85 seconds
```
The section that contains the **PORT** and other information is what you want to focus on, nmap is letting you know which 'doors or windows' are open to attack, the next column tells you the state of this port, the third column tells you what type of service runs on the port, the most relevant ones are **HTTPS, HTTP, SSH** . For a list of all common ports and their uses go to the **Commonly used ports** section where you will find more information.

There are other things nmap will let you know but for this extreme basics example it is not necessary to look into them too much. It is just important to understand which ports are open so on the next section you can attack in a more directed manner.

---

## Advanced uses

We have seen the basic usecase of NMAP, but it can do so so much more, it can find the version of software running on the server, or even find vulnerabilities automatically. Most of these are beyond the scope of this guide but I will mention some of them below.

**TODO: more information will come here**

---

## Commonly used Ports

these are the most common ports you will encounter when using nmap, below are the explanations, some of them are explained in a technical manner.

* Ports 20 and 21: File Transfer Protocol (FTP). FTP is for transferring files between a client and a server.
* Port 22: Secure Shell (SSH). SSH is one of many tunneling protocols that create secure network connections.
* Port 25: Simple Mail Transfer Protocol (SMTP). SMTP is used for email.
* Port 53: Domain Name System (DNS). DNS is an essential process for the modern Internet; it matches human-readable domain names to machine-readable IP addresses, enabling users to load websites and applications without memorizing a long list of IP addresses.
* Port 80: Hypertext Transfer Protocol (HTTP). HTTP is the protocol that makes the World Wide Web possible.
* Port 123: Network Time Protocol (NTP). NTP allows computer clocks to sync with each other, a process that is essential for encryption.
* Port 179: Border Gateway Protocol (BGP). BGP is essential for establishing efficient routes between the large networks that make up the Internet (these large networks are called autonomous systems). Autonomous systems use BGP to broadcast which IP addresses they control.
* Port 443: HTTP Secure (HTTPS). HTTPS is the secure and encrypted version of HTTP. All HTTPS web traffic goes to port 443. Network services that use HTTPS for encryption, such as DNS over HTTPS, also connect at this port.
* Port 500: Internet Security Association and Key Management Protocol (ISAKMP), which is part of the process of setting up secure IPsec connections.
* Port 3389: Remote Desktop Protocol (RDP). RDP enables users to remotely connect to their desktop computers from another device.
(list taken from https://www.cloudflare.com/learning/network-layer/what-is-a-computer-port/)

---

## Common NMAP usage
most of these can be combined to make a better attack if you're interested in testing that.


for basic enumeration checking only the first 1000 ports
```bash
nmap $IP
```
```bash
nmap $website
```

to scan in a way that is harder to detect (the -sS flag uses the TCP protocol to talk to the server)
```bash
sudo nmap -sS $IP
```
```bash
sudo nmap -sS $website
```

to ask NMAP to explain more the information
```bash
sudo nmap -v -sS $IP
```
```bash
sudo nmap -v -sS $website
```


---
